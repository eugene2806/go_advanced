## Команды Docker

[Создание контейнера](#создание-контейнера)  
[Запуск контейнера](#запуск-контейнера)  
[Остановка контейнера](#остановка-контейнера)  
[Удаление контейнера](#удаление-контейнера)  
[Временная остановка контейнера (pause)](#временная-остановка-контейнера)  
[Start и Restart контейнера](#start-и-restart-контейнера)  
[Выполнение bash команд внутри контейнера (exec)](#выполнение-bash-команд-внутри-контейнера)  
[Перенос файлов в контейнер и на локальную машину (cp, diff)](#перенос-файлов-в-контейнер-и-на-локальную-машину)




### Создание контейнера

* `docker create alpine:latest` - **Создает image**

* `docker images` - **Показывает все images**

* `docker ps` - **Показывает запущенные контейнеры**

* `docker ps -a` - **Показывает все контейнеры**

* `docker inspect 7b7b86ce581f` - **Показывает информацию о контейнере**


### Запуск контейнера

* `docker start 7b7b86ce581f` - **Запускает контейнер**


### Остановка контейнера

* `docker stop 7b7b86ce581f` - **Останавливает контейнер**


*Механизм: При использовании команды docker stop, контейнеру сначала посылается сигнал SIGTERM,  
который даёт процессу внутри контейнера возможность корректно завершиться. Если процесс не завершится  
в течение определённого времени (по умолчанию — 10 секунд), Docker отправит сигнал SIGKILL,  
который принудительно завершит процесс.*

*Цель: Остановка контейнера мягким способом, предоставляя приложению время на выполнение завершающих операций  
(например, завершение активных запросов, сохранение данных и т.д.).*

* `docker kill 7b7b86ce581f` - **Останавливает контейнер сразу**

*Механизм: Команда docker kill моментально отправляет контейнеру сигнал SIGKILL, что немедленно завершает процесс.  
В этом случае приложение не получает времени на корректное завершение, оно просто мгновенно останавливается.*  

*Цель: Принудительное завершение работы контейнера, если нужно быстро его остановить или если docker stop не сработал.*


### Удаление контейнера

* `docker rm (-f) 7b7b86ce581f` - **Удаляет контейнер. -f Остонавливает и удаляет контейнер**


### Временная остановка контейнера

* `docker pause 7b7b86ce581f` - **Временно останавливает контейнер для освобождения ресурсов CPU**

* `docker unpause 7b7b86ce581f` - **Запускает остановленный контейнер**

* `docker logs 7b7b86ce581f` - **Показывает логи контейнера**

* `docker stats --no-stream` - **Показывает ресурсы выделяемые под контейнеры**


### Start и Restart контейнера

#### Run
* `docker run -e POSTGRES_PASSWORD=pass postgres` - **Выполняет create + start команды (нет ввода)**

***Основные флаги для docker run***

1. `-d, --detach:` Запускает контейнер в фоновом режиме (detached mode), возвращая управление терминалу.  
`docker run -e POSTGRES_PASSWORD=pass -d postgres` - **Выполняет create + start команды (есть ввод команд)**  
2. `-it:` Объединение двух флагов:  
-i, --interactive: Поддерживает стандартный ввод (stdin), чтобы контейнер оставался активным для ввода команд.  
-t, --tty: Создаёт псевдотерминал, что удобно для запуска интерактивных приложений.  
3. `--env, -e:` Передаёт переменные окружения в контейнер.
4. `-p, --publish:` Пробрасывает порты из контейнера на хост-машину.  
Формат: хостовый_порт:порт_контейнера. `docker run -p 8080:80 nginx`

#### Restart   
* `docker restart (-t, --time) 7b7b86ce581f` - **Перезапускает контейнер. -t, --time время ожидания перед перезапуском**

***Варианты политики перезапуска:***  
`docker run --restart=always my_container`

1. `no` (по умолчанию): Docker не будет автоматически перезапускать контейнер.  
2. `always:` Docker всегда будет перезапускать контейнер, если он остановлен, независимо от причины.  
Контейнер также будет перезапускаться после перезапуска хоста Docker.   
3. `on-failure[:max-retries]:` Docker перезапустит контейнер только в случае, если он завершился с ошибкой  
(ненулевой код выхода). Можно указать максимальное количество попыток перезапуска.  
Пример: **on-failure:5** — перезапустит контейнер до 5 раз, если он завершился с ошибкой.
4. `unless-stopped:` Контейнер будет перезапущен всегда, кроме случая, когда его явно остановили.  
После перезапуска хоста Docker контейнер также будет перезапущен.


### Выполнение bash команд внутри контейнера

* `docker exec 7b7b86ce581f ls` - **Выполнит команду ls внутри контейнера**
* `docker exec 327 which sh(bash)` - **Проверяет установленные оболочки**

***Основные флаги для docker exec***

1. `-i, --interactive:` Оставляет стандартный ввод (stdin) открытым, чтобы взаимодействовать с процессом.  
Это позволяет передавать команды в контейнер в реальном времени.  
`docker exec -i 327 sh` - **Передает команды в оболочку shell в контейнере**
2. `-t, --tty:` Создаёт псевдотерминал (tty), что особенно полезно для работы с интерактивными программами  
(например, запуском shell сессии). Часто используется с флагом -i для интерактивного сеанса.  
`docker exec -it 327 sh` - **Создаст терминал для работы в контейнере**  
`docker run -it alpine sh` - **Запустит контейнер сразу вызвав терминал**


### Перенос файлов в контейнер и на локальную машину

* `docker cp copy_test 7b7b86ce581f:/` - **Копирование папки из корня на локальной машине в корень контейнера**

* `docker cp 7b7b86ce581f:/copy_test/copy.txt copy.txt  ` - **Копирование файла из папки контейнера в корень на локальной машине**

* `docker diff 7b7b86ce581f` - **Показывает все изменения в контейнере**
   













